SELECT DISTINCT
  expert_sr_seg_table.segmentationInstanceUID,
  expert_sr_seg_table.sourceSegmentedSeriesUID,
  expert_sr_seg_table.Quantity.CodeMeaning as expert_QuantityCodeMeaning,
  expert_sr_seg_table.Quantity.CodeValue as expert_QuantityCodeValue,
  expert_sr_seg_table.Value as expert_Value,
  expert_sr_seg_table.Units.CodeValue as expert_UnitsCodeValue,
  expert_sr_seg_table.Units.CodeMeaning as expert_UnitsCodeMeaning,
  expert_sr_seg_table.findingSite.CodeValue as expert_findingSiteCodeValue,
  expert_sr_seg_table.findingSite.CodeMeaning as expert_findingSiteCodeMeaning,
  ai_sr_seg_table.Quantity.CodeMeaning as ai_QuantityCodeMeaning,
  ai_sr_seg_table.Quantity.CodeValue as ai_QuantityCodeValue,
  ai_sr_seg_table.Quantity.CodingSchemeDesignator as ai_QuantityCodingSchemeDesignator,
  ai_sr_seg_table.Value as ai_Value,
  ai_sr_seg_table.Units.CodeValue as ai_UnitsCodeValue,
  ai_sr_seg_table.Units.CodeMeaning as ai_UnitsCodeMeaning,
  ai_sr_seg_table.findingSite.CodeValue as ai_findingSiteCodeValue,
  ai_sr_seg_table.findingSite.CodeMeaning as ai_findingSiteCodeMeaning,
  expert_sr_seg_table.StudyInstanceUID,
  expert_sr_seg_table.SeriesInstanceUID,
  expert_sr_seg_table.SegmentedPropertyCategory.CodeValue as SegmentedPropertyCategoryCodeValue,
  expert_sr_seg_table.SegmentedPropertyCategory.CodeMeaning as SegmentedPropertyCategoryCodeMeaning,
  expert_sr_seg_table.SegmentedPropertyType.CodeValue as SegmentedPropertyTypeCodeValue,
  expert_sr_seg_table.SegmentedPropertyType.CodeMeaning as SegmentedPropertyTypeCodeMeaning,
  expert_sr_seg_table.SegmentAlgorithmType,
  expert_sr_seg_table.SegmentAlgorithmName,
  expert_sr_seg_table.SegmentNumber,
  expert_sr_seg_table.segmented_SeriesInstanceUID,
  expert_sr_seg_table.measurements_SOPInstanceUID as expert_measurements_SOPInstanceUID,
  expert_sr_seg_table.segmentations_SOPInstanceUID as segmentation_SOPInstanceUID,
  expert_sr_seg_table.refSerieUID,
  expert_sr_seg_table.ai_serieUID,
  expert_sr_seg_table.gold_serieUID,
  expert_sr_seg_table.segment,
  expert_sr_seg_table.dsc,
  expert_sr_seg_table.hsdff,
  expert_sr_seg_table.hsdff_95,
  expert_sr_seg_table.tp,
  expert_sr_seg_table.fp,
  expert_sr_seg_table.tn,
  expert_sr_seg_table.fn,
  expert_sr_seg_table.se,
  expert_sr_seg_table.sp,
  expert_sr_seg_table.prediction_time,
  expert_sr_seg_table.asd,
  expert_sr_seg_table.algorithmNameCollection,
  expert_sr_seg_table.collection_id,
  expert_sr_seg_table.image_SeriesInstanceUID,
  CONCAT(CAST(expert_sr_seg_table.image_PixelSpacingX AS STRING), ',', 
  CAST(expert_sr_seg_table.image_PixelSpacingX AS STRING)) as image_PixelSpacing,
  expert_sr_seg_table.image_SliceThickness,
  expert_sr_seg_table.image_MagneticFieldStrength,
  expert_sr_seg_table.image_SeriesDate,
  expert_sr_seg_table.image_StudyDate,
  expert_sr_seg_table.image_StudyDescription,
  expert_sr_seg_table.image_StudyDescription,
  expert_sr_seg_table.image_Manufacturer,
  expert_sr_seg_table.image_ManufacturerModelName,
  expert_sr_seg_table.image_PatientID,
  expert_sr_seg_table.viewer_url
FROM 
  `idc-sandbox-003.prostate_benchmarking_neurips_2024.combine_seg_sr_expert_dicom_all_table` as expert_sr_seg_table
LEFT JOIN `idc-sandbox-003.prostate_benchmarking_neurips_2024.combine_seg_sr_ai_dicom_all_table`
   as ai_sr_seg_table
ON expert_sr_seg_table.segmentations_SOPInstanceUID = ai_sr_seg_table.segmentations_SOPInstanceUID
AND expert_sr_seg_table.segment = ai_sr_seg_table.segment
AND expert_sr_seg_table.SegmentedPropertyType.CodeMeaning = ai_sr_seg_table.SegmentedPropertyType.CodeMeaning
WHERE
  expert_sr_seg_table.Quantity.CodeMeaning = "Volume of Mesh"
AND
  (ai_sr_seg_table.Quantity.CodeMeaning = "Volume of Mesh" OR IFNULL(ai_sr_seg_table.Quantity.CodeMeaning, 'empty') = 'empty')